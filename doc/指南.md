# 指南

## 功能
#### 代码生成器
* 使用代码生成器，实体类必须遵循规范
字段和类上都需要声明注解EntityDoc
基本类型的字段，必须使用包装类型
类上必须声明@TableName("xxxx")，数据库表名由此获取
时间字段，必须使用java.util.Date、java.time.LocalDate、java.time.LocalDateTime
建议建立实体类时，数据库表名不要使用sys_前缀，这是系统自带数据表的前缀，在生成sql时系统会自动跳过表面带有该前缀的实体类

## 框架思路
* 字典与字典类型
  - 字典类型开发时配置好后不允许修改，因为字典类型可能被代码里枚举等写死，用户编辑字典类型可能导致系统错误
  - 保留字典类型管理页面，但是不建议实际使用时暴露给用户使用

* 权限管理
  * 不使用权限框架
  * 数据结构：
    - 用户 - 角色 - 功能 - 接口api
    - 用户 - 角色 - 菜单
      - 功能、接口均携带模块字段（从字典表里获取），模块字段主要用于方便查看，分类
      - 每个功能里包含多条接口api记录
      - 菜单与功能是多对多 功能与接口是多对多
  * localStorage只存储了token和permitApiList
    - 刷新页面会重新获取菜单树、接口树
    - 删除token将失去登录状态
    - 修改了接口权限，需要重新登录，因为后台是通过解析token来校验是否有权限
    - 修改菜单后刷新即可生效
  * 根据权限显示隐藏按钮
    前端使用v-if以及isUrlPermit方法实现此功能
  * 后台对权限的校验
    AOP登录校验和权限校验时，会从token里解析出该用户有权限的接口url集合，然后在里面查找是否包含了当前请求url，不包含则说明没有权限
  * 如何配置权限
    * 开发者
      - 在字典表里配置模块类型（方便增加接口url时配置模块名称）
      - 配置接口url列表
      - 在前端代码里对相应按钮添加v-if根据权限显示隐藏
    * 使用者
      - 增加角色
      - 在字典表里配置模块类型（方便增加功能时配置模块名称）
      - 增加功能
      - 配置该角色所拥有的功能列表
      - 配置该功能所拥有的url接口列表
